---
apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: "{{ ocp4_workload_quay_operator_registry_name }}"
  namespace: "{{ ocp4_workload_quay_operator_registry_namespace }}"
spec:
  configBundleSecret: config-bundle
  components:
  - kind: postgres
    managed: true
  - kind: objectstorage
    managed: true
  - kind: redis
    managed: true
  - kind: tls
    managed: true
  - kind: route
    managed: true
  - kind: quay
    managed: true
    overrides:
      replicas: 1
      resources:
        requests:
          cpu: '1'
          memory: 2Gi
        limits:
          cpu: '2'
          memory: 4Gi
  - kind: clair
    managed: {{ ocp4_workload_quay_operator_registry_enable_clair }}
{% if ocp4_workload_quay_operator_registry_enable_clair | bool %}
    overrides:
      replicas: 1
      volumeSize: {{ ocp4_workload_quay_operator_registry_clair_volume_size }}
      resources:
        requests:
          cpu: 500m
          memory: 1Gi
        limits:
          cpu: '1'
          memory: 2Gi
{% endif %}
  - kind: clairpostgres
    managed: true
  - kind: horizontalpodautoscaler
    managed: {{ ocp4_workload_quay_operator_registry_enable_hpa }}
  - kind: mirror
    managed: {{ ocp4_workload_quay_operator_registry_enable_mirror }}
  - kind: monitoring
    managed: {{ ocp4_workload_quay_operator_registry_enable_monitoring }}
